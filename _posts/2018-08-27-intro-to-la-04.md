---
layout: post-math-cn
title:  "线代导论 04：正交"
categories: 线性代数
tags: 线性代数导论 四个子空间 Big-Picture 空间正交 投影 最小二乘法 近似 标准正交基 Gram-Schmidt正交化
author: buzzyrain
mathjax: true
---

* content
{:toc}

正交（orthogonal）是“垂直”在线性代数中的推广概念。有两个向量 $ \boldsymbol{v},\ \boldsymbol{w} $，当这两个向量满足 $ \boldsymbol{v} \cdot \boldsymbol{w} = \boldsymbol{v}^T \boldsymbol{w} = 0 $ 时，我们说它们是正交的。

这时还满足 $ \Vert \boldsymbol{v} \Vert ^2 + \Vert \boldsymbol{w} \Vert ^2 = \Vert \boldsymbol{v} + \boldsymbol{w} \Vert ^2 $，看起来很像勾股定理 $ a^2 + b^2 = c^2 $，只是两直角边换成了 $ \boldsymbol{v},\ \boldsymbol{w} $。具体的证明是：

$ \Vert \boldsymbol{v} + \boldsymbol{w} \Vert ^2 = (\boldsymbol{v} + \boldsymbol{w})^T(\boldsymbol{v} + \boldsymbol{w}) = \boldsymbol{v}^T \boldsymbol{v} + \boldsymbol{w}^T \boldsymbol{w} $，因为 $  \boldsymbol{v}^T \boldsymbol{w} = \boldsymbol{w}^T \boldsymbol{v} = 0 $。

---

这一章我们将从向量之间的正交延伸至
- 正交的子空间（orthogonal subspaces）
- 正交的基（orthogonal bases）
- 正交的矩阵（orthogonal matrices）

要怎么让空间变得正交？

两个子空间的向量满足**任意一对向量**都正交，得，又落回向量正交。类似的，任一对基向量两两正交，正交矩阵 $ Q $ 的任一对列向量也正交。





## 四个子空间的正交性

空间 $ V $ 和空间 $ W $ 的正交是指，**所有**在 $ V $ 内的向量 $ \boldsymbol{v} $ 和**所有** $ W $ 中的向量 $ \boldsymbol{w} $ 都垂直，即满足 $ \boldsymbol{v}^T \boldsymbol{w} = 0 $ 。

![orthogonal-exampels](https://wx1.sinaimg.cn/large/9f1c5669gy1fuoomk2xv1j20v80cqwky.jpg "Orthogonal Examples")

- 左图，一维空间 $ W $ 中的向量（线）与二维平面 $ W $ 中的向量处处垂直，两空间正交。
- 右图，看起来 $ V $ 和 $ W $ 正交，但不是。 $ V $ 与 $ W $ 相交于一条线，这条线并不垂直与自身，所以不正交。因为只有**零向量与自己垂直**，$ \boldsymbol{v} = \boldsymbol{0} ,\ \boldsymbol{v}^T \boldsymbol{v} = 0 $

    还可以从维度看，$ \mathrm{dim}(\boldsymbol{V}) + \mathrm{dim}(\boldsymbol{W}) <= \mathrm{dim(\ whole\ space)}$ 时才可能正交，这里三维空间中的两个平面 $ 2 + 2 > 3 $，所以不对。

我们曾经看过[“The big picture”](https://wx2.sinaimg.cn/large/9f1c5669gy1ful8os687oj210c0kwjzh.jpg)，图中画了两对**垂直**的空间，①列空间 $ \mathbb{C}(A) $ 与左零空间 $ \mathbb{N}(A^T) $ ②行空间 $ \mathbb{C}(A^T) $ 与零空间 $ \mathbb{N}(A) $。而且每一对中，零向量是唯一的交点。

---

行空间 $ \mathbb{C}(A^T) $ 中的任一向量都垂直于零空间 $ \mathbb{N}(A) $ 中的任一向量，因为 $ A \boldsymbol{x} = \boldsymbol{0} $。

$ \mathbb{N}(A),\ \mathbb{C}(A^T) $ 是 $ \mathbb{R}^n $ 空间中正交的子空间。

证明：每一（线性组合的）行向量点乘 $ \boldsymbol{x} $ 都为零。

![proof-row-null-orthogonal](https://wx3.sinaimg.cn/large/9f1c5669gy1fuopj9vvo0j20xs06ugtb.jpg "Proof of  Orthogonal Row Space and Nullspace")

还可以用简短的矩阵证明，行向量的线性组合表示为 $ A^T \boldsymbol{y} $，零空间内的向量是 $ \boldsymbol{x} $，两者的点乘是 $ \boldsymbol{x}^T(A^T \boldsymbol{y}) = (\boldsymbol{x}^TA^T) \boldsymbol{y} = (A \boldsymbol{x})^T \boldsymbol{y} = \boldsymbol{0} \boldsymbol{y} = \boldsymbol{0} $，证毕。

把上面证明中的 $ A $ 对称地换为 $ A^T $，可以得到另一对正交的空间：列空间 $ \mathbb{C}(A) $ 和左零空间 $ \mathbb{N}(A^T) $。意思是左零空间中的每一个向量 $ \boldsymbol{y} $ 都垂直于 $ A $ 的每一列。

证明：相应地，$ A^T \boldsymbol{y} = 0 $ 可以看成行与列的点积。

![proof-col-leftnull-orthogonal](https://wx1.sinaimg.cn/large/9f1c5669gy1fuopy4so25j20ta04yn00.jpg Proof of Orthogonal Column Space and Left Nullspace)

现在把**正交**与**空间的转化**在“The big picture”里标明，

![big-picture-with-orthogonal](https://wx1.sinaimg.cn/large/9f1c5669gy1fuoq205yrej212o0p21bm.jpg "The Big Picture with Orthogonal")



### 正交互补

互补指的是维度的补全，比如在 $ \mathbb{R}^n $ 中的两个子空间 $ \mathbb{C}(A^T),\ \mathbb{N}(A) $ 它们不仅是正交的，其维度加起来刚好是 $ r + (n - r) = n $，全部的 $ n $ 维。我们就称行空间与零空间正交互补，同理列空间也与左零空间正交互补。

互补也暗示着**分割**，比如 $ A \boldsymbol{x} = \boldsymbol{b} $ 中的每一个 $ \boldsymbol{x} $ 都可以分为行空间的部分 $ \boldsymbol{x}_r $ 与 零空间的部分 $ \boldsymbol{x}_n $。乘上 $ A $ 就是 $ A \boldsymbol{x} = A \boldsymbol{x}_r + A \boldsymbol{x}_n $，这一步完成了子空间的**转化**：
- 零空间转化为零向量：$ A\boldsymbol{x}_n = \boldsymbol{0} $
- 行空间转化为列空间：$ A\boldsymbol{x}_r = A\boldsymbol{x} $

举例，

![eg-1-split](https://ws2.sinaimg.cn/large/9f1c5669gy1fuorezjb6dj20uy03smz7.jpg "Example for Split")

向量 $$ \boldsymbol{x}_n = \begin{bmatrix} 2  \\ -1 \\ \end{bmatrix} $$ 在零空间中，$$ \boldsymbol{x}_r =  \begin{bmatrix} 2  \\ 4 \\ \end{bmatrix} $$ 在行空间，分割是正确的。下一节会使用“**投影（projection）**”的方法，对任意的 $ A $ 与 $ \boldsymbol{x} $，计算出 $ \boldsymbol{x}_r,\ \boldsymbol{x}_n $ 两个部分。


---

$ A $ 负责转化工作，让**每一个**向量进入列空间（包括零向量）。

利用空间的正交性我们可以证明：列空间中每一个 $ \boldsymbol{b} $ 来源于行空间中**唯一**的 $ \boldsymbol{x}_r $。

证：如果行空间的两个向量 $ \boldsymbol{x}_r,\ \boldsymbol{x}_r^{’} $ 同时使 $ A \boldsymbol{x}_r = A \boldsymbol{x}_r^{’} $，那么两者之差 $ \boldsymbol{x}_r - \boldsymbol{x}_r^{’} $ 是一种线性组合，仍然在行空间内。但此时的方程变为 $ A (\boldsymbol{x}_r - \boldsymbol{x}_r^{’}) = \boldsymbol{0} $，$ \boldsymbol{x}_r - \boldsymbol{x}_r^{’} $ 又在零空间。只有自身垂直的零向量可以是两个正交空间的交点，所以 $ \boldsymbol{x}_r = \boldsymbol{x}_r^{’} $。

将 $ \boldsymbol{x} $ 分解成 $ \boldsymbol{x}_r + A \boldsymbol{x}_n $ 时，“big picture”画成：

![big-picture-with-split](https://wx4.sinaimg.cn/large/9f1c5669gy1fuora2kc86j213i0o6h7l.jpg "The Big Picture with Orthogonal and Split")
