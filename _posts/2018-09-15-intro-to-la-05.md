---
layout: post-math-cn
title:  "线代导论 05：行列式"
categories: 线性代数
tags: 线性代数导论 行列式性质 行列式公式 行列式应用 Cramer法则
author: buzzyrain
mathjax: true
---

* content
{:toc}

方阵的**行列式（determinant）**是一个数，这个神奇的数字可以立刻告诉我们一个矩阵是否可逆（等于零时不可逆）。

如果 $ A $ 可逆且它的行列式是 $ \mathrm{det}\ A $，那么逆矩阵 $ A^{-1} $ 的行列式就是 $ 1/(\mathrm{det}\ A) $，比如 $ \mathrm{det}\ A = 2 \Rightarrow \mathrm{det}\ (A^{-1}) = \frac12 $。

行列式确实有公式直接计算 $ A^{-1} $、主元和 $ A^{-1}\boldsymbol{b} $ 的解。但是矩阵太大的时候就不用了，因为**消元法**更快。

---

这一章我们将从三个方面了解行列式
1. **性质**。比如 $ \mathrm{det}\ I=1$；交换矩阵的行向量，行列式的符号改变；行列式的线性特征（注意，不是指 $ \mathrm{det}\ (A+B)=\mathrm{det}\ A + \mathrm{det}\ B $，因为 $ \mathrm{det}\ (I+I)= 1 + 1 = 2 $，但事实上 $ \mathrm{det}\ 2I=2^n $，除了 $ n=1 $，其他时候都是不对的）等等。
2. **公式**。开始我们不用一大坨公式去定义行列式，而是从变号和线性的性质入手，继而导出三种定义的方式（每项元素都有**符号 $ 1 \ \mathrm{or} -1 $**，很重要）
    - **主元公式（pivot formula）**：$ n $ 个主元的乘积
    - **“巨人”公式（”big“ formula）**：将 $ n! $ 项加和。因为 $ n! $ 很庞大，所以叫巨人公式（乱翻译的 : ）
    - **余子式（cofactor formula）**：将 $ A_{n \times n} $ 分成 $ n $ 个小的行列式
3. **应用**，包括
    - 计算 $ A^{-1} $ 和 $ A^{-1}\boldsymbol{b} $，叫 **Cramer’s rule，克拉姆法则**。
    - 算**体积**，如果一个长方体的每边表示成 $ A $ 的行向量，那么长方体的容积就是 $ \lvert \mathrm{det}\ A \rvert $。
    - 计算**特征值** $ \lambda $，根据 $ A-\lambda I $ 等于零得到特征值。这个公式是下一章的灵魂。





## 十条性质

行列式的记号为 $ \mathrm{det}\ A $ 和 $ \lvert A \rvert $，注意矩阵用**方括号（bracket）**，行列式是**竖条（straight bars）**，比如 $ 2 \times 2 $ 矩阵 $$ \begin{bmatrix} a & b \\ c & d \\ \end{bmatrix} $$ 的行列式是 $$ \mathrm{det}\ \begin{bmatrix} a & b \\ c & d \\ \end{bmatrix} = \begin{vmatrix} a & b \\ c & d \\ \end{vmatrix} = ad-bc $$。

性质1-3可以推出另外七个，即性质4-10，我们可以用 $ 2 \times 2 $ 矩阵去简单验证它，但这些属性**对所有 $ n \times n $ 矩阵都适用**。

### 三个基本

1. **$ n \times n $ 恒等矩阵的行列式是 $ 1 $，$ \mathrm{det}\ I=1 $**

    $$ \begin{vmatrix} 1  &  &  \\   & \ddots &  \\  &  &  1 \\ \end{vmatrix} = 1 $$，以及 $$ \begin{vmatrix} 1 & 0 \\ 0 & 1 \\ \end{vmatrix} = 1-0=1 $$

2. **行交换时行列式变号（sign reversal）**

    检查：$$ \begin{vmatrix} c & d \\ a & b \\ \end{vmatrix} = bc-ad=-(ad-bc)=-\begin{vmatrix} a & b \\ c & d \\ \end{vmatrix} $$

    这个性质告诉我们置换矩阵 $ P $ 的行列式，
    - 如果将 $ I $ 的行交换偶数次，$ \mathrm{det}\ P=1 $
    - 如果是奇数次行交换，$ \mathrm{det}\ P=-1 $

3. **行列式是单独每一行的线性函数**

    **每次线性操作一行，其余行固定不变**。一行一行来，不着急。

    - **乘**任意常数 $ t $，$$ \begin{vmatrix} ta & tb \\ c & d \\ \end{vmatrix} = t (ad-bc) = t \begin{vmatrix} a & b \\ c & d \\ \end{vmatrix} $$
    - **单行相加**，$$ \begin{vmatrix} a + a' & b + b' \\ c & d \\ \end{vmatrix} = ad+a'd-bc-b'c = (ad-bc)+(a'd-b'c)=\begin{vmatrix} a & b \\ c & d \\ \end{vmatrix} + \begin{vmatrix} a' & b' \\ c & d \\ \end{vmatrix} $$

    当然这个单行的线性操作对 $ n \times n $ 都适用，只要保证每次动一行就好。

    所以之前提到的 $ \mathrm{det}\ 2I \neq 2 \mathrm{det}\ I $ 就可以解释了，为了得到 $ 2I $，我们必须将**每一行**都乘以 $ 2 $，所以如果 $ I $ 是 $ n \times n $ 的，就要乘上 $ n $ 个 $ 2 $，即 $ \mathrm{det}\ 2I = 2^n \mathrm{det}\ I $。类似有 $ \mathrm{det}\ tI=t^n $。

    这就像正方体边长 $ a $ 变成 $ 2a $ 时，它的一个表面积变为 $ (2a)^2=2^2a^2=4a^2 $，体积为 $ (2a)^3=2^3a^3=8a^3 $。


### 七个推导

为了**计算**行列式 warm up～

括号里的数字是**总的性质**排序
{: .note}

4. (4) **如果 $ A $ 有两行相同，$ \mathrm{det}\ A=0 $**

    根据性质2，交换两行要变符号。设 $ \mathrm{det}\ A=D $，但交换两个相同的行，$ A $ 还是 $ A $，行列式却变号了，即 $ \mathrm{det}\ A= -D $，$ D=-D $，所以 $ D=0 $。

5. (5) **$ A $ 经过行操作后，它的行列式不变**

    行操作（row operation）指的是一行减去另一行的倍数（线性操作），比如 $ \mathrm{row}_2 - l \cdot \mathrm{row}_1 $ ，$$ \begin{vmatrix} a & b \\ c-la & d-lb \\ \end{vmatrix} = \begin{vmatrix} a & b \\ c & d \\ \end{vmatrix} $$。

    性质3的线性性质可以把第二行拆解（第一行固定），并结合性质4（有相同行的矩阵行列式为零），得到 $$ \begin{vmatrix} a & b \\ c-la & d-lb \\ \end{vmatrix} = \begin{vmatrix} a & b \\ c & d \\ \end{vmatrix} + (-l)\begin{vmatrix} a & b \\ a & b \\ \end{vmatrix} = \begin{vmatrix} a & b \\ c & d \\ \end{vmatrix} $$。

    因为从 $ A \Rightarrow U $ 的消元都是行操作，所以 $ \mathrm{det}\ A=\mathrm{det}\ U $。如果有上三角矩阵 $ U $ 的行列式，那么行向量任意线性组合得到的 $ A $ 的行列式也有了。

    如果消元过程中有行交换，需要改变符号，所以严谨起见，$ \mathrm{det}\ A= \pm \mathrm{det}\ U $。

6. (6) **如果 $ A $ 有一行都是零，$ \mathrm{det}\ A=0 $**

    $$ \begin{vmatrix} 0 & 0 \\ c & d \\ \end{vmatrix} = \begin{vmatrix} a & b \\ 0 & 0 \\ \end{vmatrix} = 0 $$

    只要将零行加上其他任意一行（性质5），就有了相同的行向量，根据性质4，$ \mathrm{det}\ A=0 $。

7. (7) **如果 $ A $ 是三角矩阵，那么 $ \mathrm{det}\ A= (a_{11})(a_{22}) \cdots (a_{nn}) $，$ A $ 的行列式是主对角线元素之积**

    $$ \begin{vmatrix} a & b \\ 0 & d \\ \end{vmatrix} = \begin{vmatrix} a & 0 \\ c & d \\ \end{vmatrix} = ad $$

    因为三角矩阵很容易消元成对角矩阵，由性质5可知，它的行列式不变，再用性质3分离出 $ I $ 的对角线乘数，

    $$ \mathrm{det}\ \begin{bmatrix} a_{11}  &  &  & \\ & a_{22} & & \\ &  & \ddots &  \\ 0  &  &  & \\ \end{bmatrix} = (a_{11})(a_{22}) \cdots (a_{nn}) (\mathrm{det}\ I) = (a_{11})(a_{22}) \cdots (a_{nn}) $$

    如果对角线元素 $ a_{ii} $ 是零，$ A $ 就是奇异矩阵，这时消元产生的零行由性质6可知，$ \mathrm{det}\ A=0 $。

8. (8) **如果 $ A $ 是奇异矩阵，$ \mathrm{det}\ A=0 $；如果 $ A $ 可逆，$ \mathrm{det}\ A \neq 0 $**

    证明在上一条，因为性质5告诉我们 $ \mathrm{det}\ A=\mathrm{det}\ U $，而奇异矩阵的 $ U $ 有零行，所以 $ \mathrm{det}\ A=\mathrm{det}\ U=0 $。

    但是，如果 $ A $ 是可逆矩阵，它消元后的对角线元素都不为零，所以由性质7知 $ \mathrm{det}\ A \neq 0 $。

    考虑到可能的行交换，$ \mathrm{det}\ A= \pm\ \mathrm{det}\ U = \pm\ (\mathrm{product\ of\ the\ pivots}) $。

9. (9) **矩阵相乘 $ AB $ 的行列式 $ \mathrm{det}\ (AB) $ 是分别两个行列式之积 $ (\mathrm{det}\ A) (\mathrm{det}\ B) $ ：$ \lvert AB \rvert = \lvert A \rvert \lvert B \rvert$**

    从矩阵乘法的规则有，

    $$ \begin{vmatrix} a & b \\ c & d \\ \end{vmatrix}\begin{vmatrix} p & q \\ r & s \\ \end{vmatrix} = \begin{vmatrix} ap+br & aq+bs \\ cp+dr & cq+ds \\ \end{vmatrix} $$（有兴趣可以展开求证）

    当 $ B $ 是 $ A^{-1} $ 时，则 $ \mathrm{det}\ A^{-1}= 1/\mathrm{det}\ A $，因为 $ AA^{-1}=I,\ (\mathrm{det}\ A) (\mathrm{det}\ A^{-1}) = \mathrm{det}\ I = 1 $。

    证明 $ n \times n $ 的情况，设 $ \lvert B \rvert \neq 0 $，考虑比例 $ D(A)= \cfrac{\lvert AB \rvert}{\lvert B \rvert} $。

    【思路】检查 $ D(A) $ 是否拥有性质1、2、3，如果全都满足，则认为 $ D(A) $ 是一个行列式，$ \cfrac{\lvert AB \rvert}{\lvert B \rvert} = \lvert A \rvert $，证毕。

    - 性质1（$ \mathrm{det}\ I=1 $），如果 $ A = I $，则 $ D(A) = \cfrac{\lvert B \rvert}{\lvert B \rvert} = 1 = \mathrm{det}\ I $，满足。
    - 性质2（行交换变号），如果 $ A $ 的两行交换了，那么 $ AB $ 的相应的两行也交换，所以 $ AB $ 改变了符号，此时的比例 $ D(A) $ 也变号。
    - 性质3（线性）当 $ A $ 的行1乘上了 $ t $，$ AB $ 的行1同样也都乘上了 $ t $，比例 $ \cfrac{\lvert AB \rvert}{\lvert B \rvert} $ 也乘上 $ t $。同理加法。

    所以，比例 $ \cfrac{\lvert AB \rvert}{\lvert B \rvert} $ 与 $ \lvert A \rvert $ 的三个基本性质相同，即 $ \cfrac{\lvert AB \rvert}{\lvert B \rvert} = \lvert A \rvert,\ \lvert AB \rvert = \lvert A \rvert \lvert B \rvert $。

    对于 $ \lvert B \rvert = 0 $ 的情况，这时的 $ B $ 是奇异矩阵，乘积 $ AB $ 也是不可逆的，所以 $ \lvert AB \rvert = \lvert A \rvert \lvert B \rvert = 0 $。

    证明完毕。

10. (10) **$ A $ 的转置矩阵 $ A^T $ 与 $ A $ 有相同的行列式，$ \mathrm{det}\ A^T=\mathrm{det}\ A $**

    $$ \begin{vmatrix} a & b \\ c & d \\ \end{vmatrix} = \begin{vmatrix} a & c \\ b & d \\ \end{vmatrix}  = ad - bc $$

    $ \mathrm{det}\ A=0 $，奇异矩阵 $ \mathrm{det}\ A^T = \mathrm{det}\ A = 0 $。否则 $ \mathrm{det}\ A \neq 0 $ 时，$ LU $ 分解得 $ PA=LU $。

    两边转置，$ A^TP^T = U^TL^T $，应用性质9，比较 $ \mathrm{det}\ P\ \mathrm{det}\ A = \mathrm{det}\ L\ \mathrm{det}\ U $ 与 $ \mathrm{det}\ A^T \mathrm{det}\ P^T = \mathrm{det}\ U^T \mathrm{det}\ L^T $：

    - $ \mathrm{det}\ L = \mathrm{det}\ L^T = 1 $，其对角线元素都是1
    - $ \mathrm{det}\ U = \mathrm{det}\ U^T $，三角矩阵的转置，对角线元素不变
    - $ \mathrm{det}\ P = \mathrm{det}\ P^T $，因为置换矩阵的行列式要么等于 $ 1 $，要么等于 $ -1 $，而且 $ PP^T=I,\ \lvert P \rvert \lvert P^T \rvert = \lvert I \rvert = 1 $，所以 $ \mathrm{det}\ P $ 与 $ \mathrm{det}\ P^T $ 必定是**同号**的。

    证明了其中三对元素都相等，所以 $ \lvert A \rvert = \lvert A^T \rvert $。

    👉 **每一个对行适用的性质都可以用于列**。

    只要转置就好，因为刚证明了 $ \lvert A \rvert = \lvert A^T \rvert $。比如呢，列交换符号改变；有一列全是零的矩阵的行列式为零；如果有一列都乘以了 $ t $，它的行列式也乘以 $ t $；行列式是每一单独列的线性函数 等等......


### 练习

**Q1**. 已知 $ A $ 的行列式，分别找到下列矩阵的行列式
- $ M_1 $：每一个 $ a_{ij} $ 乘以 $ (-1)^{i+j} $ 得到星盘状分布的 $$ \begin{bmatrix} a_{11} & -a_{12} & a_{13} \\ -a_{21} & a_{22} & -a_{23} \\ a_{31} & -a_{32} & a_{33} \\ \end{bmatrix} $$
- $ M_2 $：$ 1,\ 2,\ 3 $ 行分别从 $ 2,\ 3,\ 1 $ 行中减去，$$ \begin{bmatrix} row_1 - row_3 \\ row_2 - row_1 \\ row_3 - row_2 \\ \end{bmatrix} $$
- $ M_3 $：$ 1,\ 2,\ 3 $ 行分别加上 $ 2,\ 3,\ 1 $ 行，$$ \begin{bmatrix} row_1 + row_3 \\ row_2 + row_1 \\ row_3 + row_2 \\ \end{bmatrix} $$

1. $ M_1 $ 乘上的 $ (-1)^{i+j} $ 可以看作对角矩阵 $$ \begin{bmatrix} 1 &  &  \\  & -1 &  \\  &  & 1 \\ \end{bmatrix} $$ 同时作用在**行与列**，即 $$ M_1 = \begin{bmatrix} 1  &  &  \\  & -1  &  \\  &  &  1 \\ \end{bmatrix}\begin{bmatrix} a_{11} & a_{12} & a_{13} \\ a_{21} & a_{22} & a_{23} \\ a_{31} & a_{32} & a_{33} \\ \end{bmatrix}\begin{bmatrix} 1 &  &  \\  & -1 &  \\  &  & 1 \\ \end{bmatrix} $$，所以行列式 $ \mathrm{det}\ M_1 = (-1)\mathrm{det}\ A (-1)= \mathrm{det}\ A $。
2. $ M_2 $ 是奇异矩阵，三行加起来是零，所以线性相关，$ \mathrm{det}\ M_2 = 0 $。
3. $ M_3 $ 可以根据性质3拆解，因为每次只能操作一行，所以一共被分成 $ 2^3=8 $ 个小矩阵，$$ \begin{bmatrix} row_1 + row_3 \\ row_2 + row_1 \\ row_3 + row_2 \\ \end{bmatrix} = \begin{bmatrix} row_1 \\ row_2 \\ row_3 \\ \end{bmatrix} + \begin{bmatrix} row_3 \\ row_2 \\ row_3 \\ \end{bmatrix} + \begin{bmatrix} row_1 \\ row_1 \\ row_3 \\ \end{bmatrix} + \cdots + \begin{bmatrix} row_3 \\ row_1 \\ row_2 \\ \end{bmatrix} $$。

    有重复行的行列式为零，且 $$ \begin{bmatrix} row_3 \\ row_1 \\ row_2 \\ \end{bmatrix} $$ 经过了两次行交换，所以 $ \mathrm{det}\ M_3 = \mathrm{det}\ A + (-1)^2 \mathrm{det}\ A = 2 \mathrm{det}\ A $

**Q2**. 一个 $ 4 \times 4 $ 的矩阵行列式 $ \mathrm{det}\ A=\frac12 $，那么
- $ \mathrm{det}\ (2A) =2^4 \mathrm{det}\ A = 16 /2 = 8 $
- $ \mathrm{det}\ (-A) = (-1)^4 \mathrm{det}\ A = \frac12 $
- $ \mathrm{det}\ (A^2) = \mathrm{det}\ A \mathrm{det}\ A = \frac12 \cdot \frac12 = \frac14 $
- $ \mathrm{det}\ (A^{-1}) = 1 / \mathrm{det}\ A = 2 $

**Q3**. 使用行操作证明 $ 3 \times 3 $ Vandermonde （范德蒙）矩阵的行列式，$$ \begin{vmatrix} 1 & a & a^2 \\ 1 & b & b^2 \\  1 & c & c^2 \\ \end{vmatrix} = (b-a)(c-a)(c-b) $$

1.  $ \mathrm{row}_2 - \mathrm{row}_1,\ \mathrm{row}_3 - \mathrm{row}_1 $ 得到 $$ \begin{vmatrix} 1 & a & a^2 \\ 0 & b-a & b^2-a^2 \\  0 & c-a & c^2-a^2 \\ \end{vmatrix} $$。

2. 现在**第一列**看起来很整洁，采用**列操作**，$ \mathrm{col}_3 - a \cdot \mathrm{col}_1,\ \mathrm{col}_3 - a^2 \cdot \mathrm{col}_1 $ ，$$ \begin{vmatrix} 1 & 0 & 0 \\ 0 & b-a & b^2-a^2 \\  0 & c-a & c^2-a^2 \\ \end{vmatrix} $$

3. 用块矩阵的视角发现这是一个对角矩阵 $$ \begin{vmatrix}  D_1 &  \\ & D_2 \\ \end{vmatrix} $$，$$ \mathrm{det}\ D_2 = \begin{vmatrix} b-a & b^2-a^2 \\  c-a & c^2-a^2 \\ \end{vmatrix} = (b-a)(c-a) \begin{vmatrix} 1 & b+a \\ 1 & c+a \\ \end{vmatrix} = (b-a)(c-a) \begin{vmatrix} 1 & b+a \\ 0 & c-b \\ \end{vmatrix} = (b-a)(c-a)(c-b) $$
