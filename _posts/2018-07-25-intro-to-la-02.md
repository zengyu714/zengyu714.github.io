---
layout: post-math-cn
title:  "线代导论 02：求解线性方程"
categories: 线性代数
tags: 线性代数导论 线性方程 消元 逆矩阵 LU分解 转置矩阵 置换矩阵
author: buzzyrain
mathjax: true
---

* content
{:toc}

**线性**代数的最关注的问题是怎样解一个**线性**方程组，线性指的是未知数们仅会被乘上常数 $ cx $，而不是另一个未知数，像 $ x \cdot y $。

我们先看一个小小的二元一次方程：

*[二元一次]: 线性的再次确认

$$
\left\{
\begin{array}{c}
x - 2y = 1 \\
3x + 2y = 11 \\
\end{array}
\right.
\tag{1}\label{1}
$$

准备从三个不同的切入点求解它：①行 ②列 ③矩阵。


## 三个角度

1. **行**视角 <br>
    方程 $ (\ref{1}) $ 里的每一行都是 $ xy $ 平面上的一条直线，方程的解是两条直线的交点。<br>
    ![row-picture](https://wx2.sinaimg.cn/large/9f1c5669gy1ftmkpbxgw9j20lf0c2wij.jpg "ROW")
    {:class="img-mid"}

2. **列**视角 <br>
    将列**向量**作为方程的元素，列向量的线性组合恰好等于 $ \boldsymbol{b}  $，

    $$
        x\begin{bmatrix}  1 \\ 3  \\ \end{bmatrix} +
        y\begin{bmatrix} -2 \\ 2  \\ \end{bmatrix} =
         \begin{bmatrix}  1 \\ 11 \\ \end{bmatrix} = \boldsymbol{b}
    $$

    当正确选择了 $ x = 3, \ y= 1 $ (与**行视角中的直线交点**一致)后，我们惊喜的发现 :poop:，$ 3(column 1) + 1 (column 2) = \boldsymbol{b} $。

    ![column-picture](https://wx4.sinaimg.cn/large/9f1c5669gy1ftmko7ji0cj20xg0hxn6w.jpg "COLUMN")
    {:class="img-mid"}

    强调一下，左侧的向量方程仍是**线性组合**，有着两个基本操作，①分别**乘**以3和1 ②然后**加**在一起。

3. **矩阵**视角 <br>
    最后整体看一下方程左边，有一个系数矩阵 (coefficient matrix) $ A_{2 \times 2} $ ，

    $$
    A =
    \begin{bmatrix}
    1 & -2 \\
    3 & 2  \\
    \end{bmatrix}
    $$

    加上两个未知数 $ x, \ y $，得到真正的矩阵问题 $ A \boldsymbol{x} = \boldsymbol{b}  $，

    $$
    A \boldsymbol{x} = \boldsymbol{b} \qquad
    \begin{bmatrix}
    1 & -2 \\
    3 & 2  \\
    \end{bmatrix}
    \begin{bmatrix}  x \\ y  \\ \end{bmatrix} =
    \begin{bmatrix}  1 \\ 11 \\ \end{bmatrix}
    $$


### 三元一次再应用

刚才以二元方程为例，现在用稍加复杂（并没有）的三元一次方程再练习一次，感受一下哪个视角比较明晰。
三个未知数 $ x,\ y, \ z $，三个线性方程，

$$
A \boldsymbol{x} = \boldsymbol{b} \qquad
\left\{
\begin{aligned}
 x + 2y + 3z &= 6 \\
2x + 5y + 2z &= 4 \\
6x - 3y +  z &= 2
\end{aligned}
\right.
\tag{2}\label{2}
$$

这三个未知数 $ x,\ y, \ z $ 可能有解，也可能无解，通常方程数和未知数相等时有解。

1. 行视角 <br>
    三个平面相交于一点。
    ![row-picture-3-eqs](https://wx3.sinaimg.cn/large/9f1c5669gy1ftnloy6eihj20je097n1x.jpg "Three equations in row picture")

2. 列视角 <br>
    列向量的结合

    $$
        x\begin{bmatrix}  1 \\ 2  \\ 6   \\ \end{bmatrix} +
        y\begin{bmatrix}  2 \\ 5  \\ -3  \\ \end{bmatrix} +
        z\begin{bmatrix}  3 \\ 2  \\ 1   \\ \end{bmatrix} =
        \begin{bmatrix}   6 \\ 4  \\ 2  \\ \end{bmatrix} = \boldsymbol{b}
    $$

    **立刻**发现 $ \boldsymbol{b} = (6,\ 4,\ 2) $ 刚好是第三列的两倍。答案昭然若揭，$ x = 0,\ y = 0,\ z = 2 $。<br>

    ![col-picture-3-eqs](  http://wx3.sinaimg.cn/large/9f1c5669gy1ftnlv3erxej20fb098djk.jpg "Three equations in column picture")

3. 矩阵视角 <br>
    写成整块矩阵的形式，$ A \boldsymbol{x} = \boldsymbol{b} $， 其中 $ A $ 是 $ 3 \times 3 $ 的系数矩阵。

    $$
    A \boldsymbol{x} = \boldsymbol{b} \qquad
    \begin{bmatrix}
    1 &  2 & 3  \\
    2 &  5 & 2  \\
    6 & -3 & 1  \\
    \end{bmatrix}
    \begin{bmatrix}  x \\ y  \\ z \\ \end{bmatrix} =
    \begin{bmatrix}  6 \\ 4  \\ 2 \\ \end{bmatrix}
    $$


### Python中的矩阵乘法

[`Numpy`](http://www.numpy.org/)是科学计算的基石，`import numpy as np`是我们熟悉的好旁友！<br>
我们以它的矩阵操作为例，

```python
import numpy as np

# Matrix init
A = np.array([[1, 2, 3], [2, 5, 2], [6, -3, 1]])
x = np.array([[0, 0, 2]]).T;
# >>> OUT
# A: array([[ 1,  2,  3],
#           [ 2,  5,  2],
#           [ 6, -3,  1]])
# x: array([[0],
#           [0],
#           [2]])

# Three ways for matrix multiplication
b1 = np.dot(A, x)
b2 = A @ x
b3 = np.matmul(A, x);
# >>> OUT
# b1 == b2 == b3: array([[6],
#                        [4],
#                        [2]])

# WARNING
b_broadcast = A * x;
# >>> OUT
# b_broadcast: array([[ 0,  0,  0],
#                     [ 0,  0,  0],
#                     [12, -6,  2]])
```

#### 注意
{: .no_toc}

1. `*`运算符在`np.array`中是矩阵**元素**乘法，有[**broadcast**](https://docs.scipy.org/doc/numpy-1.13.0/user/basics.broadcasting.html)机制，即两个逐元素操作的矩阵不需要形状严格相等，其中一个矩阵的某一维度可以是1，只要最终**广播**后的形状一致，运算就会顺利进行。如果与原意不符，能错得措不及防，所以多加小心。

1. 矩阵乘法最好使用`np.matmul`或者`a @ b`，`np.dot`的适用范围见[文档](https://docs.scipy.org/doc/numpy-1.14.0/reference/generated/numpy.dot.html)。

1. 构建矩阵的时候，也可以用`np.mat`，但此时的矩阵乘法在[`np.matrix`](https://docs.scipy.org/doc/numpy-1.14.0/reference/generated/numpy.matrix.html#numpy.matrix)语境下就是`*`算符。

    ```python
    A = np.mat('1, 2, 3; 2, 5, 2; 6, -3, 1')
    b = np.mat('6, 4, 2').T
    x = np.linalg.solve(A, b);

    # IMPORTANT
    b = A * x
    ```
